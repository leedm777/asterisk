Index: aconfigure
===================================================================
--- aconfigure	(revision 5497)
+++ aconfigure	(working copy)
@@ -718,6 +718,9 @@
 ac_ct_AR
 AR
 RANLIB
+ac_ct_OBJC
+OBJCFLAGS
+OBJC
 ac_ct_CXX
 CXXFLAGS
 CXX
@@ -842,6 +845,8 @@
 CXX
 CXXFLAGS
 CCC
+OBJC
+OBJCFLAGS
 CPP'
 
 
@@ -1560,6 +1565,8 @@
               you have headers in a nonstandard directory <include dir>
   CXX         C++ compiler command
   CXXFLAGS    C++ compiler flags
+  OBJC        Objective C compiler command
+  OBJCFLAGS   Objective C compiler flags
   CPP         C preprocessor
 
 Use these variables to override the choices made by `configure' or to help
@@ -1718,6 +1725,44 @@
 
 } # ac_fn_cxx_try_compile
 
+# ac_fn_objc_try_compile LINENO
+# -----------------------------
+# Try to compile conftest.$ac_ext, and return whether this succeeded.
+ac_fn_objc_try_compile ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  rm -f conftest.$ac_objext
+  if { { ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compile") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && {
+	 test -z "$ac_objc_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then :
+  ac_retval=0
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_retval=1
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_objc_try_compile
+
 # ac_fn_c_try_link LINENO
 # -----------------------
 # Try to link conftest.$ac_ext, and return whether this succeeded.
@@ -3635,6 +3680,251 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
+ac_ext=m
+ac_cpp='$OBJCPP $CPPFLAGS'
+ac_compile='$OBJC -c $OBJCFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$OBJC -o conftest$ac_exeext $OBJCFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_objc_compiler_gnu
+if test -n "$ac_tool_prefix"; then
+  for ac_prog in gcc objcc objc cc CC
+  do
+    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
+set dummy $ac_tool_prefix$ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_OBJC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$OBJC"; then
+  ac_cv_prog_OBJC="$OBJC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+    ac_cv_prog_OBJC="$ac_tool_prefix$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+OBJC=$ac_cv_prog_OBJC
+if test -n "$OBJC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $OBJC" >&5
+$as_echo "$OBJC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+    test -n "$OBJC" && break
+  done
+fi
+if test -z "$OBJC"; then
+  ac_ct_OBJC=$OBJC
+  for ac_prog in gcc objcc objc cc CC
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_OBJC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_OBJC"; then
+  ac_cv_prog_ac_ct_OBJC="$ac_ct_OBJC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+    ac_cv_prog_ac_ct_OBJC="$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_OBJC=$ac_cv_prog_ac_ct_OBJC
+if test -n "$ac_ct_OBJC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_OBJC" >&5
+$as_echo "$ac_ct_OBJC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  test -n "$ac_ct_OBJC" && break
+done
+
+  if test "x$ac_ct_OBJC" = x; then
+    OBJC="gcc"
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    OBJC=$ac_ct_OBJC
+  fi
+fi
+
+# Provide some information about the compiler.
+$as_echo "$as_me:${as_lineno-$LINENO}: checking for Objective C compiler version" >&5
+set X $ac_compile
+ac_compiler=$2
+for ac_option in --version -v -V -qversion; do
+  { { ac_try="$ac_compiler $ac_option >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    sed '10a\
+... rest of stderr output deleted ...
+         10q' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+  fi
+  rm -f conftest.er1 conftest.err
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU Objective C compiler" >&5
+$as_echo_n "checking whether we are using the GNU Objective C compiler... " >&6; }
+if ${ac_cv_objc_compiler_gnu+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+#ifndef __GNUC__
+       choke me
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_objc_try_compile "$LINENO"; then :
+  ac_compiler_gnu=yes
+else
+  ac_compiler_gnu=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+ac_cv_objc_compiler_gnu=$ac_compiler_gnu
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_objc_compiler_gnu" >&5
+$as_echo "$ac_cv_objc_compiler_gnu" >&6; }
+if test $ac_compiler_gnu = yes; then
+  GOBJC=yes
+else
+  GOBJC=
+fi
+ac_test_OBJCFLAGS=${OBJCFLAGS+set}
+ac_save_OBJCFLAGS=$OBJCFLAGS
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $OBJC accepts -g" >&5
+$as_echo_n "checking whether $OBJC accepts -g... " >&6; }
+if ${ac_cv_prog_objc_g+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_save_objc_werror_flag=$ac_objc_werror_flag
+   ac_objc_werror_flag=yes
+   ac_cv_prog_objc_g=no
+   OBJCFLAGS="-g"
+   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_objc_try_compile "$LINENO"; then :
+  ac_cv_prog_objc_g=yes
+else
+  OBJCFLAGS=""
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_objc_try_compile "$LINENO"; then :
+
+else
+  ac_objc_werror_flag=$ac_save_objc_werror_flag
+	 OBJCFLAGS="-g"
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_objc_try_compile "$LINENO"; then :
+  ac_cv_prog_objc_g=yes
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_objc_werror_flag=$ac_save_objc_werror_flag
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_objc_g" >&5
+$as_echo "$ac_cv_prog_objc_g" >&6; }
+if test "$ac_test_OBJCFLAGS" = set; then
+  OBJCFLAGS=$ac_save_OBJCFLAGS
+elif test $ac_cv_prog_objc_g = yes; then
+  if test "$GOBJC" = yes; then
+    OBJCFLAGS="-g -O2"
+  else
+    OBJCFLAGS="-g"
+  fi
+else
+  if test "$GOBJC" = yes; then
+    OBJCFLAGS="-O2"
+  else
+    OBJCFLAGS=
+  fi
+fi
 ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
@@ -3641,7 +3931,13 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
+
 if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
 set dummy ${ac_tool_prefix}ranlib; ac_word=$2
@@ -9998,4 +10294,3 @@
 
 The next step now is to run 'make dep' and 'make'.
 " >&6; }
-
Index: aconfigure.ac
===================================================================
--- aconfigure.ac	(revision 5497)
+++ aconfigure.ac	(working copy)
@@ -11,11 +11,11 @@
 		  pjmedia/include/pjmedia-codec/config_auto.h
 		  pjsip/include/pjsip/sip_autoconf.h
 		 ])
-AC_CONFIG_FILES([build.mak 
-		 build/os-auto.mak 
+AC_CONFIG_FILES([build.mak
+		 build/os-auto.mak
 		 build/cc-auto.mak
-		 pjlib/build/os-auto.mak 
-		 pjlib-util/build/os-auto.mak 
+		 pjlib/build/os-auto.mak
+		 pjlib-util/build/os-auto.mak
 		 pjmedia/build/os-auto.mak
 		 pjsip/build/os-auto.mak
 		 third_party/build/os-auto.mak
@@ -38,6 +38,7 @@
 dnl #
 AC_PROG_CC
 AC_PROG_CXX
+AC_PROG_OBJC
 AC_LANG([C])
 
 AC_PROG_RANLIB
@@ -71,7 +72,7 @@
 AC_SUBST(ac_pjdir)
 AC_SUBST(ac_build_mak_vars)
 
-case $host in 
+case $host in
     *mingw* | *cygw* | *win32* | *w32* )
 	if pwd -W 2&> /dev/null; then
 	   ac_pjdir=`pwd -W`
@@ -188,7 +189,7 @@
 	       fi],
 	      [
 		AC_DEFINE(PJ_HAS_FLOATING_POINT,1)
-	        AC_MSG_RESULT([Checking if floating point is disabled... no]) 
+	        AC_MSG_RESULT([Checking if floating point is disabled... no])
 	      ])
 
 
@@ -419,7 +420,7 @@
 
 dnl ######################
 dnl # ioqueue selection
-dnl # 
+dnl #
 AC_SUBST(ac_os_objs)
 AC_SUBST(ac_linux_poll)
 AC_MSG_CHECKING([ioqueue backend])
@@ -761,7 +762,7 @@
 	      		     [Disable video feature]),
 	      [if test "$enable_video" = "no"; then
 	        #AC_DEFINE(PJMEDIA_HAS_VIDEO,0)
-                AC_MSG_RESULT([Video is disabled]) 
+                AC_MSG_RESULT([Video is disabled])
                 enable_sdl="no"
                 enable_ffmpeg="no"
                 enable_v4l2="no"
@@ -1035,7 +1036,7 @@
                   else
 			AC_PATH_PROGS(SDL_CONFIG, sdl2-config sdl-config)
 		  fi
-		  
+
 		  AC_MSG_CHECKING([SDL availability])
 		  if test "x$SDL_CONFIG" = "x"; then
 			AC_MSG_RESULT([not found])
@@ -1112,13 +1113,13 @@
 				ac_ffmpeg_cflags="$ac_ffmpeg_cflags -DPJMEDIA_HAS_LIBAVUTIL=1"
 				av_pkg="$av_pkg libavutil"
 			fi
-			
+
 			if test "x$av_pkg" == "x"; then
 			   AC_MSG_RESULT([none detected (check the prefix)! **])
 			else
 			   AC_MSG_RESULT([$av_pkg])
 			fi
-			
+
 			ac_ffmpeg_cflags="$ac_ffmpeg_cflags `$PKG_CONFIG --cflags $av_pkg`"
 			ac_ffmpeg_ldflags="$ac_ffmpeg_ldflags `$PKG_CONFIG --libs $av_pkg`"
 
@@ -1126,13 +1127,13 @@
 			dnl #
 			dnl # Use hardcoded values to configure ffmpeg
 			dnl #
-			
+
 			AC_MSG_RESULT([*** Warning: neither pkg-config nor python is available, ffmpeg dependency cannot be calculated. If ffmpeg libraries are not detected, you need to specify the correct CFLAGS and LDFLAGS settings for ffmpeg prior to invoking configure ***])
-			
+
 			LIBS="-L$FFMPEG_PREFIX/lib $LIBS"
 			LDFLAGS="-L$FFMPEG_PREFIX/lib $LDFLAGS"
 			CFLAGS="-I$FFMPEG_PREFIX/include $CFLAGS"
-			
+
 			AC_CHECK_LIB(avdevice,
 				     avdevice_version,
 				     [ac_ffmpeg_cflags="$ac_ffmpeg_cflags -DPJMEDIA_HAS_LIBAVDEVICE=1"
@@ -1175,15 +1176,15 @@
 				      ac_ffmpeg_ldflags="$ac_ffmpeg_ldflags -lavcore"
 				     ]
 				     )
-			
+
 		fi
-		
+
 		AC_CHECK_TYPES(enum AVPixelFormat,
 			       [],
 			       [ac_ffmpeg_cflags="$ac_ffmpeg_cflags -DPJMEDIA_USE_OLD_FFMPEG=1"],
 			       [[#include <libavformat/avformat.h>]]
 			     )
-				     
+
 		LIBS="$LIBS $ac_ffmpeg_ldflags"
 		export PKG_CONFIG_PATH=$SAVED_PKG_CONFIG_PATH
 	      ]
@@ -1238,25 +1239,25 @@
 		  if test "x$with_openh264" != "xno" -a "x$with_openh264" != "x"; then
 		        OPENH264_PREFIX=$with_openh264
 		  	OPENH264_CFLAGS="-I$OPENH264_PREFIX/include"
-			OPENH264_LDFLAGS="-L$OPENH264_PREFIX/lib" 
+			OPENH264_LDFLAGS="-L$OPENH264_PREFIX/lib"
 			AC_MSG_RESULT([Using OpenH264 prefix... $with_openh264])
 		  else
 		  	OPENH264_CFLAGS=""
-			OPENH264_LDFLAGS="" 
+			OPENH264_LDFLAGS=""
 		  fi
 
 		  AC_MSG_CHECKING([OpenH264 usability])
 
 		  OPENH264_LIBS="-lopenh264 -lstdc++"
-		  
+
 		  SAVED_LIBS="$LIBS"
 		  SAVED_LDFLAGS="$LDFLAGS"
 		  SAVED_CFLAGS="$CFLAGS"
-		  
+
 		  LIBS="$OPENH264_LIBS $LIBS"
 		  LDFLAGS="$OPENH264_LDFLAGS $LDFLAGS"
 		  CFLAGS="$OPENH264_CFLAGS $CFLAGS"
-		  
+
 		  AC_LINK_IFELSE([AC_LANG_PROGRAM([[#include <wels/codec_api.h>
 		                                    #include <wels/codec_app_def.h>
 					          ]],
@@ -1308,7 +1309,7 @@
     )
 
 if test "x$enable_ipp" != "xno"; then
-    dnl # 
+    dnl #
     dnl # Verifying Intel IPP path
     dnl #
     AC_MSG_CHECKING([Intel IPP location])
@@ -1353,7 +1354,7 @@
 
 #
 	# Some differences between Mac OS X and Linux
-	case $target in 
+	case $target in
 	    *darwin* )
 		IPP_LDFLAGS="-L$IPPROOT/Libraries -L$IPPROOT/lib"
 		;;
@@ -1405,7 +1406,7 @@
 	LIBS="$SAVED_LIBS"
     fi
 
-    dnl # 
+    dnl #
     dnl # Verifying Intel IPP samples path
     dnl #
     AC_MSG_CHECKING([Intel IPP samples location])
@@ -1431,11 +1432,11 @@
     else
 	# Remove trailing backslash
 	IPPSAMPLES=`echo $IPPSAMPLES | sed 's/\/$//'`
-	
+
 	# Guess the libusc.a/libspeech.a build location
 	AC_MSG_CHECKING([Intel IPP USC build location])
 	if test -d $IPPSAMPLES/speech-codecs/bin; then
-	    IPPVER=5 
+	    IPPVER=5
 	    IPPSAMP_DIR=`ls -d $IPPSAMPLES/speech-codecs/bin/*gcc*/lib | head -1`
 	elif test -d $IPPSAMPLES/speech-codecs/_bin; then
 	    IPPVER=6
@@ -1560,7 +1561,7 @@
 		AC_CHECK_LIB(ssl,SSL_library_init,[libssl_present=1 && LIBS="-lssl $LIBS"])
 		if test "x$openssl_h_present" = "x1" -a "x$libssl_present" = "x1" -a "x$libcrypto_present" = "x1"; then
 	        	AC_MSG_RESULT([OpenSSL library found, SSL support enabled])
-			
+
 			# Check if SRTP should be compiled with OpenSSL
 			# support, to enable cryptos such as AES GCM
 			AC_CHECK_LIB(crypto,EVP_aes_128_gcm,[ac_ssl_has_aes_gcm=1])
@@ -1572,7 +1573,7 @@
 
 			# Check if OpenSSL supports setting curve algorithm
 			# and has elliptic curve
-			
+
 			AC_MSG_CHECKING([OpenSSL setting curve functions])
 			AC_SUBST(set_curve_present,0)
 			AC_SUBST(ec_curve_present,0)
@@ -1740,7 +1741,7 @@
 		    CPPFLAGS="$CPPFLAGS -I$with_silk/interface"
                     LDFLAGS="$LDFLAGS -L$with_silk"
                     AC_MSG_RESULT([Using SILK prefix... $with_silk])
-                fi                
+                fi
 		AC_SUBST(silk_h_present)
 		AC_SUBST(silk_present)
 		AC_CHECK_HEADER(SKP_Silk_SDK_API.h,[silk_h_present=1])
@@ -1872,7 +1873,7 @@
 			;;
 		     *)
 			;;
-		esac	
+		esac
 	      ])
 
 
@@ -1971,4 +1972,3 @@
 
 The next step now is to run 'make dep' and 'make'.
 ])
-
Index: build/cc-auto.mak.in
===================================================================
--- build/cc-auto.mak.in	(revision 5497)
+++ build/cc-auto.mak.in	(working copy)
@@ -1,9 +1,10 @@
 export CC = @CC@ -c
 export CXX = @CXX@ -c
+export OBJC = @OBJC@ -c
 export AR = @AR@
 export AR_FLAGS = @AR_FLAGS@
 export LD = @LD@
-export LDOUT = -o 
+export LDOUT = -o
 export RANLIB = @RANLIB@
 
 export OBJEXT := .@OBJEXT@
@@ -19,4 +20,3 @@
 export CC_SOURCES :=
 export CC_CFLAGS := @CC_CFLAGS@
 export CC_LDFLAGS :=
-
Index: build/rules.mak
===================================================================
--- build/rules.mak	(revision 5497)
+++ build/rules.mak	(working copy)
@@ -19,7 +19,7 @@
 else ifeq ($(SHLIB_SUFFIX),dll)
 SHLIB_OPT := -shared -Wl,-soname,$(SHLIB)
 else
-SHLIB_OPT := 
+SHLIB_OPT :=
 endif
 
 #
@@ -87,7 +87,7 @@
 print_bin: print_common
 	@echo EXE=$(subst /,$(HOST_PSEP),$(BINDIR)/$(EXE))
 	@echo BINDIR=$(BINDIR)
- 
+
 print_lib: print_common
 ifneq ($(LIB),)
 	@echo LIB=$(subst /,$(HOST_PSEP),$(LIBDIR)/$(LIB))
@@ -113,7 +113,7 @@
 	$(LD) $(LDOUT)$(subst /,$(HOST_PSEP),$@) \
 	    $(subst /,$(HOST_PSEP),$(OBJS)) $($(APP)_LDFLAGS) $(SHLIB_OPT)
 endif
- 
+
 ifneq ($(SONAME),)
 $(subst /,$(HOST_PSEP),$(LIBDIR)/$(SONAME)): $(subst /,$(HOST_PSEP),$(LIBDIR)/$(SHLIB))
 	ln -sf $(SHLIB) $@
@@ -155,19 +155,19 @@
 	cp $(OBJDIR)/$(app).ko ../lib
 
 $(OBJDIR)/%$(OBJEXT): $(SRCDIR)/%.m
-	$(CC) $($(APP)_CFLAGS) \
+	$(OBJC) $($(APP)_CFLAGS) \
 		$(CC_OUT)$(subst /,$(HOST_PSEP),$@) \
-		$(subst /,$(HOST_PSEP),$<) 
+		$(subst /,$(HOST_PSEP),$<)
 
 $(OBJDIR)/%$(OBJEXT): $(SRCDIR)/%.c
 	$(CC) $($(APP)_CFLAGS) \
 		$(CC_OUT)$(subst /,$(HOST_PSEP),$@) \
-		$(subst /,$(HOST_PSEP),$<) 
+		$(subst /,$(HOST_PSEP),$<)
 
 $(OBJDIR)/%$(OBJEXT): $(SRCDIR)/%.S
 	$(CC) $($(APP)_CFLAGS) \
 		$(CC_OUT)$(subst /,$(HOST_PSEP),$@) \
-		$(subst /,$(HOST_PSEP),$<) 
+		$(subst /,$(HOST_PSEP),$<)
 
 $(OBJDIR)/%$(OBJEXT): $(SRCDIR)/%.cpp
 	$(CXX) $($(APP)_CXXFLAGS) \
@@ -241,4 +241,3 @@
 dep: depend
 
 -include $(DEP_FILE)
-
Index: build.mak.in
===================================================================
--- build.mak.in	(revision 5497)
+++ build.mak.in	(working copy)
@@ -9,7 +9,7 @@
 export CC_NAME := gcc
 export TARGET_NAME := @target@
 export CROSS_COMPILE := @ac_cross_compile@
-export LINUX_POLL := @ac_linux_poll@ 
+export LINUX_POLL := @ac_linux_poll@
 export SHLIB_SUFFIX := @ac_shlib_suffix@
 
 export prefix := @prefix@
@@ -163,7 +163,7 @@
 SDL_LDFLAGS = @ac_sdl_ldflags@
 
 # FFMPEG flags
-FFMPEG_CFLAGS = @ac_ffmpeg_cflags@ 
+FFMPEG_CFLAGS = @ac_ffmpeg_cflags@
 FFMPEG_LDFLAGS =  @ac_ffmpeg_ldflags@
 
 # Video4Linux2
@@ -171,7 +171,7 @@
 V4L2_LDFLAGS = @ac_v4l2_ldflags@
 
 # OPENH264 flags
-OPENH264_CFLAGS = @ac_openh264_cflags@ 
+OPENH264_CFLAGS = @ac_openh264_cflags@
 OPENH264_LDFLAGS =  @ac_openh264_ldflags@
 
 # QT
@@ -195,6 +195,7 @@
 # CFLAGS, LDFLAGS, and LIBS to be used by applications
 export APP_CC := @CC@
 export APP_CXX := @CXX@
+export APP_OBJC := @OBJC@
 export APP_CFLAGS := -DPJ_AUTOCONF=1\
 	@CFLAGS@\
 	$(PJ_VIDEO_CFLAGS) \
